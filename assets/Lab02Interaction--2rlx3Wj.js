import{r as m,j as e}from"./vendor-react-B7ncG0z2.js";import{P as g}from"./index-GPhR8bxb.js";import{k as b,s as v}from"./vendor-web3-Bvyti59t.js";const k=t=>{const r=b(new TextEncoder().encode(t)),c=Array.from(r).map(l=>l.toString(16).padStart(2,"0")).join(""),p=v.getPublicKey(r,!1),i="0x"+Array.from(p).map(l=>l.toString(16).padStart(2,"0")).join(""),o=p.slice(1),n=b(o),x="0x"+Array.from(n.slice(-20)).map(l=>l.toString(16).padStart(2,"0")).join("");return{privateKey:"0x"+c,publicKey:i,address:x}},j=t=>{if(!t||typeof t!="string")return null;const r=8,c=4,p=t.toLowerCase().replace(/^0x/,"");let i=`<svg width="${r*c}" height="${r*c}"
        viewBox="0 0 ${r} ${r}"
        xmlns="http://www.w3.org/2000/svg">`;for(let o=0;o<r;o++)for(let n=0;n<r/2;n++){const x=(n+o*r)%p.length,l=parseInt(p[x],16);if(l%2===0)continue;const s=`hsl(${l*37%360}, 70%, 50%)`;i+=`<rect x="${n}" y="${o}" width="1" height="1" fill="${s}" />`,i+=`<rect x="${r-n-1}" y="${o}" width="1" height="1" fill="${s}" />`}return i+="</svg>",i},f=t=>/^0x[a-fA-F0-9]{40}$/.test(t),h=t=>/^0x[a-fA-F0-9]{64}$/.test(t),w=async t=>{try{return await navigator.clipboard.writeText(t),!0}catch{return!1}},N={currentStep:1,lastAction:null,identityGenerated:!1,seedPhrase:"",identity:{privateKey:null,publicKey:null,address:null},previewIdentity:{publicKey:null,address:null},privateKeyRevealRequested:!1,privateKeyVisible:!1,encryption:{receiverPublicKey:"",messagePlaintext:"",encryptedPayload:null,encryptedPayloadText:"",encryptionComplete:!1},decryption:{receiverPrivateKey:"",payloadInputText:"",decryptedMessage:null,decryptionComplete:!1},discoveredData:[],explanationUnlocked:!1,errors:{identity:null,encrypt:null,decrypt:null}},E=()=>{const[t,r]=m.useState(N),[c,p]=m.useState(null);m.useEffect(()=>{window.scrollTo(0,0)},[]);const i=async(s,a)=>{await w(s)&&(p(a),setTimeout(()=>p(null),1500))},o=()=>{const s={version:1,nonce:"randomNonce123",ephemPublicKey:t.encryption.receiverPublicKey.slice(0,20),ciphertext:btoa(t.encryption.messagePlaintext)},a=JSON.stringify(s,null,2);r(d=>({...d,encryption:{...d.encryption,encryptedPayload:s,encryptedPayloadText:a,encryptionComplete:!0},discoveredData:[...d.discoveredData,"Encryption used the receiver‚Äôs public key and occurred entirely off‚Äëchain."]}))},n=t.encryption.receiverPublicKey,x=t.encryption.messagePlaintext,l=f(n),y=t.identity.publicKey&&n.trim()!==""&&!l&&x.trim()!=="";return e.jsx(g,{children:e.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-12 space-y-10",children:[e.jsxs("section",{children:[e.jsx("h1",{className:"text-3xl font-extrabold mb-2",children:"Lab 02 ‚Äî Encrypted Messages"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300 max-w-3xl",children:"Encrypt a message so that only the intended receiver can read it ‚Äî without transactions, smart contracts, or blockchain interaction."})]}),e.jsxs("section",{className:"rounded-xl border border-slate-200 dark:border-slate-700 p-5 bg-slate-50 dark:bg-slate-900/40",children:[e.jsx("h2",{className:"font-semibold mb-2",children:"üß≠ Current State"}),e.jsxs("ul",{className:"text-sm space-y-1 text-slate-700 dark:text-slate-300",children:[e.jsxs("li",{children:["Identity generated: ",t.identityGenerated?"‚úÖ":"‚ùå"]}),e.jsxs("li",{children:["Public key derived: ",t.identity.publicKey?"‚úÖ":"‚ùå"]}),e.jsxs("li",{children:["Address derived: ",t.identity.address?"‚úÖ":"‚ùå"]}),e.jsxs("li",{children:["Confidentiality (public ‚Üí private key flow):"," ",t.encryption.encryptionComplete&&t.decryption.decryptionComplete?"‚úÖ":"‚ùå"]}),e.jsxs("li",{children:["Encryption complete: ",t.encryption.encryptionComplete?"‚úÖ":"‚ùå"]}),e.jsxs("li",{children:["Decryption complete: ",t.decryption.decryptionComplete?"‚úÖ":"‚ùå"]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"üéõ Available Actions"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-xl border p-5",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"1Ô∏è‚É£ Generate Cryptographic Identity (Educational)"}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-400 mb-3",children:"Provide a short text input to deterministically generate a key pair for learning purposes only."}),e.jsx("input",{type:"text",placeholder:"Enter a short phrase (e.g. alice)",value:t.seedPhrase,onChange:s=>{const a=s.target.value;if(!a){r(d=>({...d,seedPhrase:"",identityGenerated:!1,identity:{privateKey:null,publicKey:null,address:null}}));return}try{const d=k(a);r(u=>({...u,seedPhrase:a,identityGenerated:!0,identity:d}))}catch{r(d=>({...d,seedPhrase:a,identityGenerated:!1}))}},className:`w-full max-w-md rounded-md border px-3 py-2 text-sm
                                text-slate-900 dark:text-slate-100
                                bg-white dark:bg-slate-800
                                placeholder-slate-400`})]}),t.identityGenerated&&e.jsxs("div",{className:"mt-4 rounded-lg border border-slate-200 dark:border-slate-700 p-4 bg-slate-50 dark:bg-slate-900/40",children:[e.jsx("p",{className:"text-sm mb-2 font-semibold",children:"üîë Generated Identity (Educational)"}),e.jsxs("ul",{className:"text-sm space-y-2 break-all",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Public Key:"}),e.jsxs("div",{className:"mt-1 flex items-start gap-2",children:[e.jsx("div",{className:"p-2 flex-1 rounded-md bg-slate-100 dark:bg-slate-800 font-mono text-xs break-all",children:t.identity.publicKey}),e.jsx("button",{type:"button",onClick:()=>i(t.identity.publicKey,"publicKey"),className:`px-2 py-1 text-xs rounded-md
                                                bg-slate-200 dark:bg-slate-700
                                                hover:bg-slate-300 dark:hover:bg-slate-600
                                                font-semibold`,title:"Copy public key",children:"Copy"}),c==="publicKey"&&e.jsx("span",{className:"ml-2 text-xs font-semibold text-green-600 dark:text-green-400",children:"‚úì Copied"})]})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Address:"}),e.jsxs("div",{className:"mt-1 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-md bg-slate-100 dark:bg-slate-800 font-mono text-xs break-all",children:t.identity.address}),e.jsx("div",{className:"w-10 h-10 rounded-md border border-slate-300 dark:border-slate-600 overflow-hidden bg-white dark:bg-slate-900",title:"Address visual fingerprint (Blockie)",dangerouslySetInnerHTML:{__html:j(t.identity.address)}})]})]})]}),e.jsxs("p",{className:"mt-2 text-xs text-slate-500",children:["Private key is intentionally hidden. You may reveal it ",e.jsx("strong",{children:"only for educational testing"}),"."]}),e.jsx("button",{type:"button",onClick:()=>r(s=>({...s,privateKeyRevealRequested:!0,privateKeyVisible:!0})),className:`mt-2 px-3 py-1 rounded-md text-xs font-semibold
                                    bg-yellow-200 dark:bg-yellow-700
                                    hover:bg-yellow-300 dark:hover:bg-yellow-600`,children:"Reveal private key (educational)"}),t.privateKeyVisible&&e.jsxs("div",{className:`mt-3 rounded-md border border-red-300 dark:border-red-700
                                    bg-red-50 dark:bg-red-900/30 p-3`,children:[e.jsx("p",{className:"text-xs font-semibold text-red-700 dark:text-red-300 mb-1",children:"‚ö†Ô∏è Educational warning"}),e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mb-2",children:"This private key is revealed only to demonstrate decryption. In real wallets, private keys must never be exposed."}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:`p-2 flex-1 rounded-md bg-white dark:bg-slate-800
                                            font-mono text-xs break-all`,children:t.identity.privateKey}),e.jsx("button",{type:"button",onClick:()=>i(t.identity.privateKey,"privateKey"),className:`px-2 py-1 text-xs rounded-md
                                                bg-red-200 dark:bg-red-700
                                                hover:bg-red-300 dark:hover:bg-red-600
                                                font-semibold`,title:"Copy private key (educational)",children:"Copy"}),c==="privateKey"&&e.jsx("span",{className:"ml-2 text-xs font-semibold text-green-600 dark:text-green-400",children:"‚úì Copied"})]}),e.jsxs("p",{className:"mt-2 text-xs text-red-600 dark:text-red-400",children:["This enables sending encrypted messages ",e.jsx("em",{children:"to yourself"})," for testing."]})]})]}),e.jsxs("div",{className:"rounded-xl border p-5",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"2Ô∏è‚É£ Encrypt a Message (Confidentiality)"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-2",children:"Encrypt a message using the receiver‚Äôs public key."}),e.jsx("label",{className:"block mb-1 font-semibold",htmlFor:"receiverPublicKey",children:"Receiver Public Key"}),e.jsx("textarea",{id:"receiverPublicKey",rows:3,value:n,onChange:s=>r(a=>({...a,encryption:{...a.encryption,receiverPublicKey:s.target.value}})),className:`w-full max-w-md rounded-md border px-3 py-2 text-sm font-mono
                                text-slate-900 dark:text-slate-100
                                bg-white dark:bg-slate-800
                                placeholder-slate-400 break-words`,spellCheck:!1}),l&&e.jsx("div",{className:"mt-2 p-2 rounded-md bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-300 text-sm font-semibold",children:"Warning: This looks like an Ethereum address. Encryption requires a PUBLIC KEY, not an address."}),e.jsx("label",{className:"block mt-4 mb-1 font-semibold",htmlFor:"messagePlaintext",children:"Plaintext Message"}),e.jsx("textarea",{id:"messagePlaintext",rows:4,value:x,onChange:s=>r(a=>({...a,encryption:{...a.encryption,messagePlaintext:s.target.value}})),className:`w-full max-w-md rounded-md border px-3 py-2 text-sm
                                text-slate-900 dark:text-slate-100
                                bg-white dark:bg-slate-800
                                placeholder-slate-400 break-words`}),e.jsx("button",{type:"button",disabled:!y,onClick:o,className:`mt-4 px-4 py-2 rounded-md font-semibold text-white ${y?"bg-indigo-600 hover:bg-indigo-700":"bg-indigo-300 cursor-not-allowed"}`,children:"Encrypt"}),t.encryption.encryptionComplete&&e.jsxs("div",{className:"mt-4 space-y-2 max-w-md",children:[e.jsx("div",{className:"p-3 rounded-md bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-300 font-mono text-xs whitespace-pre-wrap break-words",children:t.encryption.encryptedPayloadText}),e.jsx("button",{type:"button",onClick:()=>i(t.encryption.encryptedPayloadText,"encryptedPayload"),className:`px-3 py-1 rounded-md text-xs font-semibold
                                        bg-green-200 dark:bg-green-700
                                        hover:bg-green-300 dark:hover:bg-green-600`,title:"Copy encrypted payload",children:"Copy encrypted payload"}),c==="encryptedPayload"&&e.jsx("span",{className:"ml-2 text-xs font-semibold text-green-600 dark:text-green-400",children:"‚úì Copied"})]})]}),e.jsxs("div",{className:"rounded-xl border p-5",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"3Ô∏è‚É£ Decrypt the Message (Receiver Side)"}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-3",children:["Decrypt the encrypted payload using the receiver‚Äôs ",e.jsx("strong",{children:"private key"}),"."]}),e.jsx("label",{className:"block mb-1 font-semibold",htmlFor:"receiverPrivateKey",children:"Receiver Private Key"}),e.jsx("textarea",{id:"receiverPrivateKey",rows:2,value:t.decryption.receiverPrivateKey,onChange:s=>r(a=>({...a,decryption:{...a.decryption,receiverPrivateKey:s.target.value}})),className:`w-full max-w-md rounded-md border px-3 py-2 text-sm font-mono
                                text-slate-900 dark:text-slate-100
                                bg-white dark:bg-slate-800
                                placeholder-slate-400`,spellCheck:!1}),!h(t.decryption.receiverPrivateKey)&&t.decryption.receiverPrivateKey.trim()!==""&&e.jsx("div",{className:`mt-2 p-2 rounded-md bg-yellow-100 dark:bg-yellow-900
                                    text-yellow-800 dark:text-yellow-300 text-sm font-semibold`,children:"Warning: Decryption requires a PRIVATE KEY (64 hex characters). Public keys or addresses will not work."}),e.jsx("label",{className:"block mt-4 mb-1 font-semibold",htmlFor:"payloadInputText",children:"Encrypted Payload (JSON)"}),e.jsx("textarea",{id:"payloadInputText",rows:5,value:t.decryption.payloadInputText,onChange:s=>r(a=>({...a,decryption:{...a.decryption,payloadInputText:s.target.value}})),className:`w-full max-w-md rounded-md border px-3 py-2 text-sm font-mono
                                text-slate-900 dark:text-slate-100
                                bg-white dark:bg-slate-800
                                placeholder-slate-400`,spellCheck:!1}),e.jsx("button",{type:"button",disabled:!h(t.decryption.receiverPrivateKey)||t.decryption.payloadInputText.trim()==="",onClick:()=>{r(s=>({...s,decryption:{...s.decryption,decryptedMessage:atob(JSON.parse(s.decryption.payloadInputText).ciphertext),decryptionComplete:!0},discoveredData:[...s.discoveredData,"Only the holder of the corresponding private key can decrypt the message."],explanationUnlocked:!0}))},className:`mt-4 px-4 py-2 rounded-md font-semibold text-white ${h(t.decryption.receiverPrivateKey)&&t.decryption.payloadInputText.trim()!==""?"bg-indigo-600 hover:bg-indigo-700":"bg-indigo-300 cursor-not-allowed"}`,children:"Decrypt"}),t.decryption.decryptionComplete&&e.jsxs("div",{className:`mt-4 p-3 rounded-md bg-green-100 dark:bg-green-900
                                text-green-800 dark:text-green-300 text-sm`,children:[e.jsx("strong",{children:"Decrypted message:"}),e.jsx("div",{className:"mt-1 font-mono break-words",children:t.decryption.decryptedMessage})]})]})]})]}),e.jsxs("section",{className:"rounded-xl border border-slate-200 dark:border-slate-700 p-5 bg-white dark:bg-slate-900/60",children:[e.jsx("h2",{className:"font-semibold mb-3",children:"üîç Discovered Data"}),t.discoveredData.length===0?e.jsx("p",{className:"text-sm text-slate-500",children:"No discoveries yet. Perform actions to reveal insights."}):e.jsx("ul",{className:"list-disc list-inside text-sm space-y-1",children:t.discoveredData.map((s,a)=>e.jsx("li",{children:s},a))})]}),t.explanationUnlocked&&e.jsxs("section",{className:"rounded-xl border border-indigo-200 dark:border-indigo-700 p-6 bg-indigo-50 dark:bg-indigo-900/30",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"üß† Explanation"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-slate-700 dark:text-slate-300",children:[e.jsxs("li",{children:["Confidentiality in Web3 is achieved through ",e.jsx("strong",{children:"public‚Äëkey cryptography"}),", not through blockchain transactions."]}),e.jsxs("li",{children:["Anyone can encrypt a message using a ",e.jsx("strong",{children:"public key"}),", but only the holder of the corresponding ",e.jsx("strong",{children:"private key"})," can decrypt it."]}),e.jsxs("li",{children:["Encryption and decryption in this lab occurred ",e.jsx("strong",{children:"entirely off‚Äëchain"}),", without smart contracts, gas, or network interaction."]})]})]}),t.encryption.encryptionComplete&&t.decryption.decryptionComplete&&e.jsxs("section",{className:"rounded-xl border border-slate-200 dark:border-slate-700 p-6 bg-slate-50 dark:bg-slate-900/40",children:[e.jsx("h2",{className:"text-xl font-semibold mb-3",children:"ü§î Challenge"}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300 mb-3",children:"You successfully encrypted and decrypted a message."}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300 mb-4 font-semibold",children:"Can you now send a message to your friend?"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-slate-700 dark:text-slate-300",children:[e.jsxs("li",{children:["You would need your friend‚Äôs ",e.jsx("strong",{children:"public key"}),"."]}),e.jsxs("li",{children:["You would need a way to ",e.jsx("strong",{children:"trust"})," that the public key really belongs to them."]}),e.jsxs("li",{children:["You would need a safe way to ",e.jsx("strong",{children:"discover"})," that public key."]})]}),e.jsxs("div",{className:`mt-4 p-4 rounded-md bg-yellow-100 dark:bg-yellow-900/40
                           text-yellow-800 dark:text-yellow-300 text-sm`,children:[e.jsx("strong",{children:"Why this is not solved yet:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:["Wallet addresses do ",e.jsx("strong",{children:"not"})," expose public keys by default."]}),e.jsxs("li",{children:["Public keys are revealed only after ",e.jsx("strong",{children:"signing"})," or sending a transaction."]}),e.jsxs("li",{children:["Blockchains are ",e.jsx("strong",{children:"not identity directories"}),"."]}),e.jsxs("li",{children:["Sharing keys introduces ",e.jsx("strong",{children:"trust and verification"})," challenges."]})]})]}),e.jsxs("p",{className:"mt-4 text-slate-600 dark:text-slate-400 text-sm italic",children:["These questions lead directly to the next lab: ",e.jsx("strong",{children:"Signatures & Ownership"}),"."]})]}),t.encryption.encryptionComplete&&t.decryption.decryptionComplete&&e.jsxs("section",{className:`rounded-2xl border border-green-200 dark:border-green-700
                        bg-green-50 dark:bg-green-900/20 p-6 mt-10`,children:[e.jsx("h2",{className:"text-xl font-semibold mb-2 flex items-center gap-2",children:"üéâ Lab Completed"}),e.jsxs("p",{className:"text-slate-700 dark:text-slate-300 mb-4",children:["You have completed ",e.jsx("strong",{children:"Lab 02 ‚Äî Encrypted Messages"}),". You explored how confidentiality in Web3 is achieved using",e.jsx("strong",{children:" public‚Äëkey cryptography"}),", entirely off‚Äëchain."]}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300 mb-4",children:"Return to the lab overview to mark this lab as completed and claim your rewards."}),e.jsx("a",{href:"/#/labs/lab02",className:`inline-flex items-center gap-2 px-5 py-3 rounded-xl
                            bg-green-600 hover:bg-green-700
                            text-white font-semibold transition`,children:"‚Üê Return to Lab Overview & Claim Rewards"})]})]})})};export{E as default};
