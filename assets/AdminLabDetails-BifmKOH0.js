import{d as N,u as v,r as d,j as e}from"./vendor-react-DaA--_H6.js";import{u as g}from"./vendor-web3-B5M9rCAm.js";const w="https://web3edu-api.dimikog.org";function E(){const{labId:l}=N(),o=v(),{address:n}=g(),[s,u]=d.useState(null),[j,i]=d.useState(!0),[m,x]=d.useState(null),[b,h]=d.useState(null),f=s?.entries?[...s.entries].sort((t,a)=>{const r=t.completedAtEpoch||t.startedAtEpoch||0;return(a.completedAtEpoch||a.startedAtEpoch||0)-r}):[];return d.useEffect(()=>{async function t(){try{if(!n){x("Admin wallet not connected."),i(!1);return}const a=await fetch(`${w}/admin/labs/details?wallet=${n}&labId=${l}`);if(!a.ok)throw new Error("Failed to fetch lab details");const r=await a.json();u(r)}catch(a){console.error(a),x("Could not load lab details.")}finally{i(!1)}}t()},[l,n]),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("button",{onClick:()=>o("/admin"),className:"inline-flex items-center gap-1.5 text-sm text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-100 transition mb-2",children:"← Back to Dashboard"}),e.jsxs("h1",{className:"text-3xl font-bold",children:["Lab Details: ",l]})]}),j&&e.jsx("div",{className:"text-slate-400",children:"Loading lab analytics..."}),m&&e.jsx("div",{className:"text-red-400",children:m}),s?.summary&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid md:grid-cols-5 gap-6",children:[e.jsx(c,{label:"Total Users",value:s.summary.totalUsers}),e.jsx(c,{label:"Started",value:s.summary.started}),e.jsx(c,{label:"Completed",value:s.summary.completed}),e.jsx(c,{label:"Drop-off",value:s.summary.dropOff}),e.jsx(c,{label:"Completion %",value:s.summary.started>0?Math.round(s.summary.completed/s.summary.started*100)+"%":"0%"})]}),e.jsxs("div",{className:"mt-10",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"User Breakdown"}),e.jsx("div",{className:"overflow-x-auto border border-slate-800 rounded-xl",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-slate-900/60",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left",children:"Wallet"}),e.jsx("th",{className:"p-3 text-left",children:"Started"}),e.jsx("th",{className:"p-3 text-left",children:"Completed"}),e.jsx("th",{className:"p-3 text-left",children:"Started At"}),e.jsx("th",{className:"p-3 text-left",children:"Completed At"}),e.jsx("th",{className:"p-3 text-left",children:"XP"})]})}),e.jsx("tbody",{children:f.map(t=>{const a=t.wallet?`${t.wallet.slice(0,6)}...${t.wallet.slice(-4)}`:"-",r=b===t.wallet;function p(){navigator.clipboard.writeText(t.wallet),h(t.wallet),setTimeout(()=>h(null),1500)}return e.jsxs("tr",{className:"border-t border-slate-800 hover:bg-slate-800/40",children:[e.jsx("td",{className:"p-3 font-mono text-xs",children:e.jsxs("span",{className:"inline-flex items-center gap-2",children:[a,e.jsx("button",{onClick:p,title:t.wallet,className:"text-slate-500 hover:text-slate-200 transition text-[10px]",children:r?"✓":"⎘"})]})}),e.jsx("td",{className:"p-3 font-semibold",children:t.started?e.jsx("span",{className:"text-green-500",children:"✔"}):e.jsx("span",{className:"text-red-500",children:"✖"})}),e.jsx("td",{className:"p-3 font-semibold",children:t.completed?e.jsx("span",{className:"text-green-500",children:"✔"}):e.jsx("span",{className:"text-red-500",children:"✖"})}),e.jsx("td",{className:"p-3",children:t.startedAt||"-"}),e.jsx("td",{className:"p-3",children:t.completedAt||"-"}),e.jsx("td",{className:"p-3",children:t.xp})]},t.wallet)})})]})})]})]})]})}function c({label:l,value:o}){return e.jsxs("div",{className:"bg-slate-900/40 border border-slate-800 rounded-xl p-6",children:[e.jsx("div",{className:"text-sm text-slate-400",children:l}),e.jsx("div",{className:"text-2xl font-semibold mt-1",children:o})]})}export{E as default};
