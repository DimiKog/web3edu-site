import{u as g,j as e,r as i}from"./vendor-react-B7ncG0z2.js";import{P as m}from"./index-B7sPhVuX.js";import{u as f}from"./vendor-web3-Bvyti59t.js";const p="https://web3edu-api.dimikog.org";async function j(t){const s=await fetch(`${p}/admin/overview?wallet=${t.toLowerCase()}`);if(!s.ok)throw new Error("Not authorized");return s.json()}async function w(t){const s=await fetch(`${p}/admin/labs/summary?wallet=${t.toLowerCase()}`);if(!s.ok)throw new Error("Not authorized");return s.json()}function v(t){return t>=.8?"text-green-600 dark:text-green-400":t>=.4?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400"}function b(t){return Math.max(0,(t.started||0)-(t.completed||0))}function k(t){return t>=5?"bg-red-50/70 dark:bg-red-900/20":t>=2?"bg-yellow-50/70 dark:bg-yellow-900/20":""}function N({labs:t}){const s=g();if(!t||t.length===0)return e.jsx("div",{className:"mt-8 text-slate-500 dark:text-slate-300",children:"No lab data available yet."});const x=t.slice().sort((r,l)=>b(l)-b(r)).reduce((r,l)=>{const a=l.category||"other";return r[a]||(r[a]=[]),r[a].push(l),r},{});return e.jsxs("div",{className:"mt-10",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-slate-900 dark:text-slate-100",children:"Labs Progress"}),e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-white/10 bg-white/60 dark:bg-[#0b0f17]/70 backdrop-blur-xl",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-white/80 dark:bg-[#111827]/80",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left text-slate-700 dark:text-slate-200",children:"Lab"}),e.jsx("th",{className:"p-3 text-left text-slate-700 dark:text-slate-200",children:"Category"}),e.jsx("th",{className:"p-3 text-center text-slate-700 dark:text-slate-200",children:"Started"}),e.jsx("th",{className:"p-3 text-center text-slate-700 dark:text-slate-200",children:"Completed"}),e.jsx("th",{className:"p-3 text-center text-slate-700 dark:text-slate-200",children:"Drop‑off"}),e.jsx("th",{className:"p-3 text-center text-slate-700 dark:text-slate-200",children:"Completion"})]})}),e.jsx("tbody",{children:Object.entries(x).map(([r,l])=>e.jsxs(i.Fragment,{children:[e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-3 py-2 text-xs font-semibold uppercase tracking-[0.2em] text-slate-600 dark:text-slate-300 bg-slate-100/70 dark:bg-slate-900/60",children:r})},r),l.map(a=>{const n=b(a);return e.jsxs("tr",{onClick:()=>s(`/admin/labs/${a.labId}`),className:`cursor-pointer border-t border-white/10 hover:bg-white/60 dark:hover:bg-white/5 transition ${k(n)}`,children:[e.jsx("td",{className:"p-3 text-slate-900 dark:text-slate-100",children:a.title?.en||a.labId}),e.jsx("td",{className:"p-3 text-sm text-slate-600 dark:text-slate-400",children:a.category}),e.jsx("td",{className:"p-3 text-center text-slate-700 dark:text-slate-200",children:a.started}),e.jsx("td",{className:"p-3 text-center text-slate-700 dark:text-slate-200",children:a.completed}),e.jsx("td",{className:"p-3 text-center text-sm font-medium text-slate-700 dark:text-slate-300",children:n}),e.jsxs("td",{className:`p-3 text-center font-semibold ${v(a.completionRate||0)}`,children:[Math.round((a.completionRate||0)*100),"%"]})]},a.labId)})]},r))})]})})]})}function C(){const{address:t}=f(),[s,x]=i.useState(null),[r,l]=i.useState(null),[a,n]=i.useState(null),[d,h]=i.useState(null);return i.useEffect(()=>{t&&j(t).then(x).catch(()=>l("Not authorized"))},[t]),i.useEffect(()=>{t&&w(t).then(c=>{c?.platform&&h(c.platform),n(c?.labs||[])}).catch(()=>{n([]),h(null)})},[t]),r?e.jsx(m,{children:e.jsx("div",{className:"min-h-screen px-6 py-20",children:e.jsx("div",{className:"max-w-4xl mx-auto rounded-2xl border border-red-500/30 bg-red-500/10 text-red-200 px-6 py-4",children:r})})}):s?e.jsx(m,{children:e.jsxs("div",{className:"relative min-h-screen px-6 py-20",children:[e.jsxs("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:[e.jsx("div",{className:"absolute -top-32 left-1/2 h-[420px] w-[420px] -translate-x-1/2 rounded-full bg-[#8A57FF]/25 blur-[140px]"}),e.jsx("div",{className:"absolute top-1/3 -right-24 h-[360px] w-[360px] rounded-full bg-[#4ACBFF]/20 blur-[140px]"}),e.jsx("div",{className:"absolute bottom-[-10%] left-[-8%] h-[320px] w-[320px] rounded-full bg-[#FF67D2]/15 blur-[130px]"})]}),e.jsxs("div",{className:"relative z-10 max-w-6xl mx-auto space-y-12",children:[e.jsx("div",{className:"flex flex-col gap-6 md:flex-row md:items-center md:justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-500 dark:text-slate-400",children:"Admin"}),e.jsx("h1",{className:"text-3xl md:text-4xl font-extrabold tracking-tight bg-gradient-to-r from-[#FF67D2] via-[#8A57FF] to-[#4ACBFF] text-transparent bg-clip-text",children:"Admin Dashboard"}),e.jsx("p",{className:"text-base text-slate-600 dark:text-slate-300 mt-2",children:"Overview & management tools for Web3Edu"})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(o,{label:"Total Users",value:s.totalUsers}),e.jsx(o,{label:"1 Lab",value:s.usersWith1Lab}),e.jsx(o,{label:"2 Labs",value:s.usersWith2Labs}),e.jsx(o,{label:"3+ Labs",value:s.usersWith3PlusLabs})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(u,{title:"Labs Analytics",description:"Completion statistics and per-lab insights",actionLabel:"View Labs",onClick:()=>window.location.hash="#/admin/labs"}),e.jsx(u,{title:"User Progress",description:"Aggregated learner progress across Web3Edu",actionLabel:"Coming soon",disabled:!0}),e.jsx(u,{title:"Identity & SBTs",description:"Inspect identity layer and skill attestations",actionLabel:"Coming soon",disabled:!0})]}),d&&e.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/70 dark:bg-[#0b0f17]/80 backdrop-blur-xl shadow-[0_24px_70px_rgba(15,23,42,0.18)] p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6 text-slate-900 dark:text-slate-100",children:"Platform Analytics"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsx(o,{label:"Started Any Lab",value:d.usersStartedAnyLab}),e.jsx(o,{label:"Completed Any Lab",value:d.usersCompletedAnyLab}),e.jsx(o,{label:"Completion (Started → Completed)",value:`${d.usersStartedAnyLab>0?Math.round(d.usersCompletedAnyLab/d.usersStartedAnyLab*100):0}%`})]})]}),e.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/70 dark:bg-[#0b0f17]/80 backdrop-blur-xl shadow-[0_24px_70px_rgba(15,23,42,0.18)] p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-slate-900 dark:text-slate-100",children:"Labs Summary"}),e.jsxs("div",{className:"mb-4 rounded-xl border border-yellow-400/50 bg-yellow-50/80 p-4 text-yellow-900 dark:border-yellow-600/40 dark:bg-yellow-950/30 dark:text-yellow-200",role:"alert",children:[e.jsx("strong",{className:"font-semibold",children:"Notice:"})," Lab start and completion are tracked separately. Drop-off reflects users who started but did not complete a lab."]}),e.jsx(N,{labs:a})]})]})]})}):e.jsx(m,{children:e.jsx("div",{className:"min-h-screen px-6 py-20",children:e.jsx("div",{className:"max-w-4xl mx-auto rounded-2xl border border-white/10 bg-white/70 dark:bg-[#0b0f17]/80 backdrop-blur-xl px-6 py-4 text-slate-700 dark:text-slate-200",children:"Loading admin data…"})})})}function o({label:t,value:s}){return e.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/70 dark:bg-[#0b0f17]/80 backdrop-blur-xl p-4 shadow-md",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-500 dark:text-slate-400",children:t}),e.jsx("div",{className:"text-2xl font-semibold text-slate-900 dark:text-slate-100 mt-1",children:s})]})}function u({title:t,description:s,actionLabel:x,onClick:r,disabled:l}){return e.jsxs("div",{className:"group relative rounded-2xl border border-white/10 bg-white/70 dark:bg-[#0b0f17]/80 backdrop-blur-xl p-6 shadow-lg",children:[e.jsx("div",{className:"absolute -inset-0.5 rounded-2xl bg-gradient-to-r from-[#8A57FF]/20 via-[#4ACBFF]/15 to-[#FF67D2]/15 opacity-0 group-hover:opacity-100 blur-sm transition-opacity duration-500"}),e.jsxs("div",{className:"relative space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:t}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:s}),e.jsx("button",{className:`inline-flex items-center justify-center rounded-xl px-4 py-2 text-sm font-semibold transition ${l?"bg-slate-200 text-slate-500 dark:bg-slate-800 dark:text-slate-400 cursor-not-allowed":"bg-slate-900 text-white hover:bg-slate-800 dark:bg-white dark:text-slate-900 dark:hover:bg-slate-200"}`,onClick:l?void 0:r,disabled:l,children:x})]})]})}export{C as default};
